#!/bin/sh
#
# Display the battery percentage.
#
# Font Awesome(no emoji) ï‰€  ï‰  ï‰‚  ï‰ƒ  ï‰„  ïƒ§ ï„ª

bat=0
bat_info=$(acpi -b | grep "Battery ${bat}")
bat_state=$(echo "${bat_info}" | grep -wo "Full\|Charging\|Discharging")
bat_power=$(echo "${bat_info}" | grep -o '[0-9]\+%' | tr -d '%')
urgent_val=15

main()
{
   if [ "${bat_state}" = "Charging" ]; then
      echo "ğŸ”Œ$(check_capacity)%"
   elif [ "${bat_state}" = "Discharging" ]; then
      echo "ğŸ”‹$(check_capacity)%"
   else
      echo "âš¡$(check_capacity)%"
   fi
}

check_capacity()
{
   local _result="${bat_power}"

   if [ "${bat_power}" -lt ${urgent_val} ] && [ "${bat_state}" = "Discharging" ]; then
      notify-send --urgency=critical "ğŸ”Œ Battery low !" "Plug the charging cable !"
   fi

   echo "${_result}"
}

main "$@"

